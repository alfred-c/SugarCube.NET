<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>
    @Styles.Render("~/Content/themes/custom-theme/css")
    @Styles.Render("~/Content/bootstrap")
    @Styles.Render("~/Content/css")
    @Styles.Render("~/Content/bootstrap-responsive")
    @Scripts.Render("~/bundles/modernizr")
    <!--[if IE]>
        @Styles.Render("~/Content/themes/base/css-ie")
    <![endif]-->
</head>
<body>
    <div class="navbar">
        <div class="navbar-inner">
            @*<a class="brand" href="#" style="font-style: italic; font-weight: bold; color: #f23996;">SugarCube</a>*@
            <a class="brand" href="#">
                <img src="~/Content/images/brand.png" alt="SugarCube.me" style="height: 20px;" /></a>
            <ul class="nav" id="filters">
                <li class="active"><a href="#" data-filter="*">All</a></li>
                <li><a href="#" data-filter=".journal">Journal</a></li>
                <li><a href="#" data-filter=".other">Other</a></li>
            </ul>
            <button id="addjournal" class="btn pull-right"><i class="icon-plus"></i>&nbsp;Journal Entry</button>
            <ul class="nav pull-right">
                @*<li><a href="#myModal" role="button" class="btn" data-toggle="modal"><i class="icon-plus"></i>Journal Entry</a></li>*@

            </ul>
        </div>
    </div>

    <div id="newjournal" style="display: none; background-color: #f9f9f9; border: 1px solid #ddd; margin-bottom: 20px">
        <div class="row-fluid">
            <div class="span12">
                <form class="form-horizontal" action="/Cube/CreateJournal" method="post">

                    <legend>New Journal Entry</legend>
                    <div class="row-fluid">
                        <div class="span8">
                            <div class="control-group">
                                <label class="control-label" for="inputDate">Date:</label>
                                <div class="controls">
                                    <input id="date" type="date" placeholder="Date" />
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label">Title:</label>
                                <div class="controls">
                                    <textarea name="title" style="display:none;"></textarea>
                                    <div contenteditable="true" id="title" data-target="title" style="min-height: 20px;"></div>
                                </div>
                            </div>
                            <div class="control-group">
                                <label class="control-label" for="entry">Content:</label>
                                <div class="controls">
                                    <textarea name="entry" style="display:none;"></textarea>
                                    <div contenteditable="true" id="entry" data-target="entry" style="min-height: 150px;"></div>
                                </div>
                            </div>
                            <div class="control-group">
                                <div class="controls">
                                    <button id="submit" type="submit" class="btn btn-primary">Create</button>
                                    <button id="cancel" class="btn">Cancel</button>
                                </div>
                            </div>
                        </div>



                        <div class="span1">

                            <div class="tabbable tabs-left tooltips">
                                <div style="margin-bottom: 5px;">
                                    <a href="#" rel="tooltip" class="btn" data-toggle="button" title="happy"><i class="sc-icon-sm-happy"></i></a>
                                    <a href="#" rel="tooltip" class="btn" data-toggle="button" title="heartbreak"><i class="sc-icon-sm-heartbreak"></i></a>
                                    <a href="#" rel="tooltip" class="btn" data-toggle="button" title="work"><i class="sc-icon-sm-work"></i></a>
                                    <a href="#" rel="tooltip" class="btn" data-toggle="button" title="finance"><i class="sc-icon-sm-finance"></i></a>
                                    <a href="#" rel="tooltip" class="btn" data-toggle="button" title="family"><i class="sc-icon-sm-family"></i></a>
                                    <a href="#" rel="tooltip" class="btn" data-toggle="button" title="misc"><i class="sc-icon-sm-misc"></i></a>
                               <input type="hidden" name="categories" />
                                </div>

                                <ul class="nav nav-tabs">

                                    <li class="active"><a href="#tab1" data-toggle="tab" rel="tooltip" title="custom tags" style="min-width: 35px;"><i class="icon-tag"></i></a></li>
                                    <li><a href="#tab2" data-toggle="tab" rel="tooltip" title="permissions" style="min-width: 35px;"><i class="icon-group"></i></a></li>

                                </ul>

                            </div>
                        </div>

                        <div class="span2 tab-content">
                            <div class="tab-pane active " id="tab1">
                                <div class="input-prepend">
                                    <span class="add-on"><i class="icon-search foreground-color"></i></span>
                                    <input type="text" class="span9" />
                                </div>
                                @foreach (SelectListItem item in Model.Tags)
                                {
                                    <a class="label" data-value="@item.Value">@item.Text</a>
                                }
                                <br />
                                <span id="addTag" contenteditable="true" style="color: #aaa; width:150px; display: inline-block;">Add new tag</span>
                                <br />
                                <a href="#">Manage tags</a>
                                <input type="hidden" name="tags" style="display:none;" />
                            </div>
                            <div class="tab-pane" id="tab2">

                                @foreach (SelectListItem item in Model.Permissions)
                                {
                                    <span  data-value="@item.Value"><a href="#" style="text-decoration:none;" ><i class="icon-eye-open unselected"></i></a> <a href="#" style="text-decoration:none;"><i class="icon-comment unselected" ></i></a> <a href="#" class="permission">@item.Text</a></span><br />
                                }

                                <a href="#">Manage crowds</a>
                                  <input type="hidden" name="visible" style="display:none;" />
                                    <input type="hidden" name="comment" style="display:none;" />
                            </div>




                        </div>

                    </div>
                </form>
            </div>
        </div>
    </div>


    @RenderBody()

    @*    <div class="modal hide fade" id="myModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h3>Journal Entry</h3>
  </div>
  <div class="modal-body">
      <input type="text" /><br />
      <input type="date" /><br />
    <textarea></textarea>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal" >Close</a>
    <a href="#" class="btn btn-primary">Save changes</a>
  </div>
</div>*@

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/jqueryui")
    @Scripts.Render("~/bundles/bootstrap")
    @Scripts.Render("~/bundles/isotope")
    @Scripts.Render("~/bundles/textchange")
    @RenderSection("scripts", required: false)
    <script type="text/javascript">
        $(function () {
            $("#addjournal, #cancel").on("click", function (e) {
                $("#newjournal").slideToggle();
                $("#title, #entry").attr("contenteditable", "true");
                e.preventDefault();
            });

            $(".tooltips").tooltip({ selector: "a[rel='tooltip']", placement: "right" });


            $("a.label").on("click", function () {
                $(this).toggleClass("background-color");
            });

            $("#entry, #title").on("textchange", function () {
                $("textarea[name='" + $(this).attr("data-target") + "']").val($(this).html());
            });


            $("#addTag").on("focus", function () {
                $(this).html("");
                $(this).css("color", "#000");
                $(this).toggleClass("editablecontent");
            });

            $("#addTag").on("blur", function () {
                $(this).html("Add new tag");
                $(this).css("color", "#aaa");
                $(this).toggleClass("editablecontent ");
            });

            $(".permission").on("click", function () {
                var $visible = $(this).parent().find("i.icon-eye-open");
                var $comment = $(this).parent().find("i.icon-comment");
                if (!$visible.hasClass("selected")) {
                    $visible.toggleClass("selected unselected");
                }
                else if ($visible.hasClass("selected") && !$comment.hasClass("selected")) {
                    $comment.toggleClass("selected unselected");
                }
                else if ($visible.hasClass("selected") && $comment.hasClass("selected")) {
                    $visible.toggleClass("selected unselected");
                    $comment.toggleClass("selected unselected");
                }
            });

            $("i.icon-eye-open, i.icon-comment").on("click", function () {
                $(this).toggleClass("selected unselected");
            });
              
            $("#submit").on("click", function () {
                var arr1 = $("a.active[rel='tooltip']").map(function () {
                    return $(this).attr("data-original-title");
                }).get();
                $("input[name='categories']").val(arr1.join(","));

                var arr2 = $("a.label.background-color").map(function () {
                    return $(this).attr("data-value");
                }).get();
                $("input[name='tags']").val(arr2.join(","));

                var arr3 = $("i.icon-eye-open.selected").map(function () {
                    return $(this).parent().attr("data-value");
                }).get();
                $("input[name='visible']").val(arr3.join(","));

                var arr4 = $("i.icon-comment.selected").map(function () {
                    return $(this).parent().attr("data-value");
                }).get();
                $("input[name='comment']").val(arr4.join(","));
                
            });
        });
    </script>
</body>
</html>
